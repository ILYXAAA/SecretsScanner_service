# Secrets Scanner Service

FastAPI-—Å–µ—Ä–≤–∏—Å –¥–ª—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–≥–æ –æ–±–Ω–∞—Ä—É–∂–µ–Ω–∏—è —Å–µ–∫—Ä–µ—Ç–æ–≤ –≤ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏—è—Ö —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º –º–∞—à–∏–Ω–Ω–æ–≥–æ –æ–±—É—á–µ–Ω–∏—è.

## üîç –û–ø–∏—Å–∞–Ω–∏–µ

–°–µ—Ä–≤–∏—Å –ø—Ä–µ–¥–Ω–∞–∑–Ω–∞—á–µ–Ω –¥–ª—è —Å–∫–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏—è —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–µ–≤ –Ω–∞ –ø—Ä–µ–¥–º–µ—Ç —É—Ç–µ—á–µ–∫ —Å–µ–∫—Ä–µ—Ç–æ–≤ (API –∫–ª—é—á–∏, –ø–∞—Ä–æ–ª–∏, —Ç–æ–∫–µ–Ω—ã –∏ —Ç.–¥.). –ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç —Ä–∞–±–æ—Ç—É —Å GitHub –∏ Azure DevOps, –æ–±–µ—Å–ø–µ—á–∏–≤–∞–µ—Ç –≤—ã—Å–æ–∫—É—é –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å –∑–∞ —Å—á–µ—Ç –º–Ω–æ–≥–æ–ø—Ä–æ—Ü–µ—Å—Å–æ—Ä–Ω–æ–π –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—ã.

## üîÅ –ü—Ä–æ—Ü–µ—Å—Å —Å–∫–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏—è (–∫—Ä–∞—Ç–∫–æ)

### 1. –ü–æ—Ç–æ–∫ –æ–±—Ä–∞–±–æ—Ç–∫–∏ –∑–∞–ø—Ä–æ—Å–∞

1. **HTTP –∑–∞–ø—Ä–æ—Å** ‚Üí FastAPI –ø—Ä–∏–Ω–∏–º–∞–µ—Ç `/scan`
2. **–í–∞–ª–∏–¥–∞—Ü–∏—è** ‚Üí –ø—Ä–æ–≤–µ—Ä—è–µ—Ç —Å—É—â–µ—Å—Ç–≤–æ–≤–∞–Ω–∏–µ –≤–µ—Ç–∫–∏/–∫–æ–º–º–∏—Ç–∞. –ï—Å–ª–∏ **–Ω–µ –Ω–∞–π–¥–µ–Ω–æ** ‚ùå, –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç –æ—à–∏–±–∫—É –≤–∞–ª–∏–¥–∞—Ü–∏–∏. –ï—Å–ª–∏ **–æ–∫** ‚úÖ, —Ç–æ –∏–¥–µ–º –¥–∞–ª–µ–µ.
3. **–û—á–µ—Ä–µ–¥—å** ‚Üí –¥–æ–±–∞–≤–ª—è–µ—Ç –∑–∞–¥–∞—á—É –≤ `asyncio.Queue`
4. **–í–æ—Ä–∫–µ—Ä –±–µ—Ä–µ—Ç –∑–∞–¥–∞—á—É** ‚Üí –æ–¥–∏–Ω –∏–∑ 10 –≤–æ—Ä–∫–µ—Ä–æ–≤ (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é) –∑–∞–±–∏—Ä–∞–µ—Ç –∏–∑ –æ—á–µ—Ä–µ–¥–∏
5. **–°–∫–∞—á–∏–≤–∞–Ω–∏–µ** ‚Üí `ThreadPoolExecutor` —Å–∫–∞—á–∏–≤–∞–µ—Ç —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π. `ThreadPoolExecutor` –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è —Ç.–∫. —ç—Ç–æ `I/O` –æ–ø–µ—Ä–∞—Ü–∏—è.
6. **–°–∫–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ** ‚Üí `ProcessPoolExecutor` –∑–∞–ø—É—Å–∫–∞–µ—Ç –æ—Ç–¥–µ–ª—å–Ω—ã–π –ø—Ä–æ—Ü–µ—Å—Å. –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è `ProcessPoolExecutor` —Ç.–∫. —ç—Ç–æ CPU –æ–ø–µ—Ä–∞—Ü–∏—è:
   - –ó–∞–≥—Ä—É–∂–∞–µ—Ç ML –º–æ–¥–µ–ª—å (Singleton)
   - –°–∫–∞–Ω–∏—Ä—É–µ—Ç —Ñ–∞–π–ª—ã –±–∞—Ç—á–∞–º–∏ –ø–æ 5
   - –ü—Ä–∏–º–µ–Ω—è–µ—Ç regex –ø—Ä–∞–≤–∏–ª–∞
   - –§–∏–ª—å—Ç—Ä—É–µ—Ç ML –º–æ–¥–µ–ª—å—é
7. **–†–µ–∑—É–ª—å—Ç–∞—Ç** ‚Üí –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç callback –Ω–∞ —É–∫–∞–∑–∞–Ω–Ω—ã–π URL

### –ü–∞—Ä–∞–ª–ª–µ–ª–∏–∑–º

- **10 –∑–∞–ø—Ä–æ—Å–æ–≤ –æ–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω–æ** ‚Üí 10 –≤–æ—Ä–∫–µ—Ä–æ–≤ –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞—é—Ç –ø–∞—Ä–∞–ª–ª–µ–ª—å–Ω–æ
- **–ö–∞–∂–¥—ã–π –≤–æ—Ä–∫–µ—Ä** = –æ—Ç–¥–µ–ª—å–Ω—ã–π –ø—Ä–æ—Ü–µ—Å—Å —Å–æ —Å–≤–æ–µ–π –º–æ–¥–µ–ª—å—é ~`51.7 MB`
- **–ë–æ–ª—å—à–µ 10 –∑–∞–ø—Ä–æ—Å–æ–≤** ‚Üí –∂–¥—É—Ç –≤ –æ—á–µ—Ä–µ–¥–∏ —Å–≤–æ–±–æ–¥–Ω–æ–≥–æ –≤–æ—Ä–∫–µ—Ä–∞. –ü—Ä–∏ –º—É–ª—å—Ç–∏-—Å–∫–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏–∏ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è 1 –≤–æ—Ä–∫–µ—Ä. –¢.–µ. –º–∞–∫—Å–∏–º—É–º –æ–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω–æ –º–æ–∂–Ω–æ –∑–∞–ø—É—Å–∫–∞—Ç—å `10 —Å–∫–∞–Ω–æ–≤` (–º—É–ª—å—Ç–∏—Å–∫–∞–Ω–æ–≤/–æ–±—ã—á–Ω—ã—Ö —Å–∫–∞–Ω–æ–≤, –Ω–µ –≤–∞–∂–Ω–æ)

## üèóÔ∏è –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞

### –ú–Ω–æ–≥–æ–ø—Ä–æ—Ü–µ—Å—Å–æ—Ä–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞
- **–û—Å–Ω–æ–≤–Ω–æ–π –ø—Ä–æ—Ü–µ—Å—Å**: FastAPI —Å–µ—Ä–≤–µ—Ä, –æ–±—Ä–∞–±–æ—Ç–∫–∞ HTTP –∑–∞–ø—Ä–æ—Å–æ–≤
- **Download Executor**: ThreadPoolExecutor –¥–ª—è —Å–∫–∞—á–∏–≤–∞–Ω–∏—è —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–µ–≤
- **Model Executor**: ProcessPoolExecutor –¥–ª—è CPU-–∏–Ω—Ç–µ–Ω—Å–∏–≤–Ω—ã—Ö –æ–ø–µ—Ä–∞—Ü–∏–π (—Å–∫–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ + ML)
- **–ê—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–∞—è –æ—á–µ—Ä–µ–¥—å**: –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∑–∞–¥–∞—á–∞–º–∏ –º–µ–∂–¥—É –ø—Ä–æ—Ü–µ—Å—Å–∞–º–∏

### –ö–æ–º–ø–æ–Ω–µ–Ω—Ç—ã —Å–∏—Å—Ç–µ–º—ã

#### 1. **API Layer** (`main.py`)
- **Endpoints**: `/scan`, `/multi_scan`, `/local_scan`
- **–ê—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è**: API –∫–ª—é—á–∏ —á–µ—Ä–µ–∑ –∑–∞–≥–æ–ª–æ–≤–∫–∏
- **–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–µ–π**: CRUD –æ–ø–µ—Ä–∞—Ü–∏–∏ –¥–ª—è –ø—Ä–∞–≤–∏–ª —Å–∫–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏—è
- **Health checks**: –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ —Å–æ—Å—Ç–æ—è–Ω–∏—è –æ—á–µ—Ä–µ–¥–∏ –∏ –≤–æ—Ä–∫–µ—Ä–æ–≤

#### 2. **Queue Worker** (`queue_worker.py`)
- **Task Queue**: –ê—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–∞—è –æ—á–µ—Ä–µ–¥—å –¥–ª—è –æ–±—Ä–∞–±–æ—Ç–∫–∏ –∑–∞–ø—Ä–æ—Å–æ–≤
- **Multi-processing**: –†–∞–∑–¥–µ–ª–µ–Ω–∏–µ I/O (Input/Output) –∏ CPU –æ–ø–µ—Ä–∞—Ü–∏–π
- **Sequential Multi-scan**: –ü–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ –º–Ω–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω—ã—Ö —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–µ–≤
- **Callback Management**: –û—Ç–ø—Ä–∞–≤–∫–∞ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤ –Ω–∞ –≤–Ω–µ—à–Ω–∏–µ URL

#### 3. **Repository Handler** (`repo_utils.py`)
- **Multi-platform Support**: GitHub –∏ Azure DevOps
- **Reference Resolving**: –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π —Ä–µ–∑–æ–ª–≤ –≤–µ—Ç–æ–∫, —Ç–µ–≥–æ–≤, –∫–æ–º–º–∏—Ç–æ–≤
- **Authentication**: PAT-—Ç–æ–∫–µ–Ω, NTLM, Negotiate
- **Safe Extraction**: –§–∏–ª—å—Ç—Ä–∞—Ü–∏—è –æ–ø–∞—Å–Ω—ã—Ö —Ñ–∞–π–ª–æ–≤ –ø—Ä–∏ —Ä–∞—Å–ø–∞–∫–æ–≤–∫–µ

#### 4. **Scanner Engine** (`scanner.py`)
- **Regex Rules**: –ù–∞—Å—Ç—Ä–∞–∏–≤–∞–µ–º—ã–µ –ø—Ä–∞–≤–∏–ª–∞ –ø–æ–∏—Å–∫–∞ —Å–µ–∫—Ä–µ—Ç–æ–≤
- **Batch Processing**: –ü–∞—Ä–∞–ª–ª–µ–ª—å–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ —Ñ–∞–π–ª–æ–≤
- **File Filtering**: –ò—Å–∫–ª—é—á–µ–Ω–∏–µ —Ñ–∞–π–ª–æ–≤ –ø–æ —Ä–∞—Å—à–∏—Ä–µ–Ω–∏—è–º –∏ –∏–º–µ–Ω–∞–º
- **False Positive Detection**: –°–∏—Å—Ç–µ–º–∞ —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–∏ –ª–æ–∂–Ω—ã—Ö —Å—Ä–∞–±–∞—Ç—ã–≤–∞–Ω–∏–π

#### 5. **ML Classifier** (`model_loader.py`)
- **Scikit-learn Model**: TF-IDF + Logistic Regression
- **Singleton Pattern**: –û–¥–∏–Ω —ç–∫–∑–µ–º–ø–ª—è—Ä –º–æ–¥–µ–ª–∏ –Ω–∞ –ø—Ä–æ—Ü–µ—Å—Å
- **Auto-training**: –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –æ–±—É—á–µ–Ω–∏–µ –ø—Ä–∏ –æ—Ç—Å—É—Ç—Å—Ç–≤–∏–∏ –º–æ–¥–µ–ª–∏
- **Confidence Scoring**: –ö–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏—è –ø–æ —É—Ä–æ–≤–Ω—è–º –¥–æ—Å—Ç–æ–≤–µ—Ä–Ω–æ—Å—Ç–∏

#### 6. **Security Layer** (`secure_save.py`)
- **Fernet Encryption**: –®–∏—Ñ—Ä–æ–≤–∞–Ω–∏–µ —Ç–æ–∫–µ–Ω–æ–≤ –∏ –ø–∞—Ä–æ–ª–µ–π
- **Environment Keys**: –ö–ª—é—á–∏ —à–∏—Ñ—Ä–æ–≤–∞–Ω–∏—è –≤ .env —Ñ–∞–π–ª–∞—Ö
- **Setup Wizard**: –ú–∞—Å—Ç–µ—Ä –ø–µ—Ä–≤–∏—á–Ω–æ–π –Ω–∞—Å—Ç—Ä–æ–π–∫–∏

## üîß –¢–µ—Ö–Ω–æ–ª–æ–≥–∏—á–µ—Å–∫–∏–π —Å—Ç–µ–∫

### Backend Framework
- **FastAPI**: –ê—Å–∏–Ω—Ö—Ä–æ–Ω–Ω—ã–π –≤–µ–±-—Ñ—Ä–µ–π–º–≤–æ—Ä–∫
- **Pydantic**: –í–∞–ª–∏–¥–∞—Ü–∏—è –¥–∞–Ω–Ω—ã—Ö –∏ –º–æ–¥–µ–ª–µ–π
- **AsyncIO**: –ê—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–æ—Å—Ç—å

### –ú–Ω–æ–≥–æ–ø—Ä–æ—Ü–µ—Å—Å–æ—Ä–Ω–æ—Å—Ç—å
- **ThreadPoolExecutor**: I/O –æ–ø–µ—Ä–∞—Ü–∏–∏ (—Å–∫–∞—á–∏–≤–∞–Ω–∏–µ)
- **ProcessPoolExecutor**: CPU –æ–ø–µ—Ä–∞—Ü–∏–∏ (—Å–∫–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ)
- **Asyncio.Queue**: –ú–µ–∂–ø—Ä–æ—Ü–µ—Å—Å–æ—Ä–Ω–∞—è –æ—á–µ—Ä–µ–¥—å

### –ú–∞—à–∏–Ω–Ω–æ–µ –æ–±—É—á–µ–Ω–∏–µ
- **Scikit-learn**: ML —Ñ—Ä–µ–π–º–≤–æ—Ä–∫
- **TF-IDF Vectorizer**: –í–µ–∫—Ç–æ—Ä–∏–∑–∞—Ü–∏—è —Ç–µ–∫—Å—Ç–∞ (char n-grams 3-5)
- **Logistic Regression**: –ë–∏–Ω–∞—Ä–Ω–∞—è –∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏—è —Å–µ–∫—Ä–µ—Ç–æ–≤
- **Joblib**: –°–µ—Ä–∏–∞–ª–∏–∑–∞—Ü–∏—è –º–æ–¥–µ–ª–µ–π

### –ü—Ä–∏–º–µ—Ä–Ω—ã–µ —Ä–∞—Å—á–µ—Ç—ã –∑–∞–Ω–∏–º–∞–µ–º–æ–π –ø–∞–º—è—Ç–∏, –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ —Å–∏–Ω–≥–ª—Ç–æ–Ω –º–æ–¥–µ–ª–∏ –Ω–∞ 10 –≤–æ—Ä–∫–µ—Ä–æ–≤, –ø—Ä–∏ 2-—Ö –¥–∞—Ç–∞—Å–µ—Ç–∞—Ö, –ø–æ 46–∫ —Å—Ç—Ä–æ–∫ –∫–∞–∂–¥—ã–π:
```ruby
MODEL MEMORY (ACTUAL):
[INFO] Vectorizer: 37.2 MB
[INFO] Model: 14.5 MB
[INFO] Vocabulary: 1,902,401 terms
[INFO] Total per process: 51.7 MB
[INFO] Estimated for 10 workers: 517.3 MB
```
#### –û–±—â–∞—è –∑–∞–Ω–∏–º–∞–µ–º–∞—è –ø–∞–º—è—Ç—å ~ `520–ú–ë`

### –†–∞–±–æ—Ç–∞ —Å —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏—è–º–∏
- **Requests**: HTTP –∫–ª–∏–µ–Ω—Ç –¥–ª—è API
- **Git**: –†–µ–∑–æ–ª–≤–∏–Ω–≥ –∫–æ–º–º–∏—Ç–æ–≤ –ø–æ —Ç–µ–≥–∞–º/–≤–µ—Ç–∫–∞–º
- **ZipFile**: –û–±—Ä–∞–±–æ—Ç–∫–∞ –∞—Ä—Ö–∏–≤–æ–≤

### –ê—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è
- **requests-ntlm**: NTLM –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è
- **requests-negotiate-sspi**: Kerberos/SPNEGO
- **HTTPBasicAuth**: Basic Auth –¥–ª—è PAT —Ç–æ–∫–µ–Ω–æ–≤

### –®–∏—Ñ—Ä–æ–≤–∞–Ω–∏–µ –∏ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å
- **Cryptography.Fernet**: –°–∏–º–º–µ—Ç—Ä–∏—á–Ω–æ–µ —à–∏—Ñ—Ä–æ–≤–∞–Ω–∏–µ
- **python-dotenv**: –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–º–∏ –æ–∫—Ä—É–∂–µ–Ω–∏—è
- **Secrets**: –ö—Ä–∏–ø—Ç–æ–≥—Ä–∞—Ñ–∏—á–µ—Å–∫–∏ —Å—Ç–æ–π–∫–∏–µ —Å—Ä–∞–≤–Ω–µ–Ω–∏—è

### –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è
- **PyYAML**: –û–±—Ä–∞–±–æ—Ç–∫–∞ YAML –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–π
- **AIOFiles**: –ê—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–∞—è —Ä–∞–±–æ—Ç–∞ —Å —Ñ–∞–π–ª–∞–º–∏

## üöÄ –ü—Ä–æ—Ü–µ—Å—Å —Ä–∞–±–æ—Ç—ã

### 1. –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è
```
FastAPI Start ‚Üí Load Model ‚Üí Start Workers ‚Üí Ready
```

### 2. –û–±—Ä–∞–±–æ—Ç–∫–∞ –∑–∞–ø—Ä–æ—Å–∞
```
HTTP Request ‚Üí Validate ‚Üí Queue ‚Üí Download ‚Üí Scan ‚Üí ML Filter ‚Üí Callback
```

### 3. –î–µ—Ç–∞–ª—å–Ω—ã–π flow

#### Single Scan (`/scan`)
1. **–í–∞–ª–∏–¥–∞—Ü–∏—è**: –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å—É—â–µ—Å—Ç–≤–æ–≤–∞–Ω–∏—è –≤–µ—Ç–∫–∏/—Ç–µ–≥–∞/–∫–æ–º–º–∏—Ç–∞
2. **Queue**: –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –≤ –∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω—É—é –æ—á–µ—Ä–µ–¥—å
3. **Download**: –°–∫–∞—á–∏–≤–∞–Ω–∏–µ –≤ ThreadPoolExecutor
4. **Scan**: –°–∫–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ –≤ ProcessPoolExecutor
5. **ML Classification**: –§–∏–ª—å—Ç—Ä–∞—Ü–∏—è ML –º–æ–¥–µ–ª—å—é
6. **Callback**: –û—Ç–ø—Ä–∞–≤–∫–∞ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤

#### Multi Scan (`/multi_scan`)
1. **Batch Validation**: –ü—Ä–æ–≤–µ—Ä–∫–∞ –≤—Å–µ—Ö —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–µ–≤
2. **Sequential Processing**: –ü–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞
3. **Individual Callbacks**: –û—Ç–¥–µ–ª—å–Ω—ã–π callback –¥–ª—è –∫–∞–∂–¥–æ–≥–æ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏—è

#### Local Scan (`/local_scan`)
1. **ZIP Upload**: –ü–æ–ª—É—á–µ–Ω–∏–µ —Ñ–∞–π–ª–∞ —á–µ—Ä–µ–∑ multipart/form-data
2. **Extract**: –†–∞—Å–ø–∞–∫–æ–≤–∫–∞ –≤–æ –≤—Ä–µ–º–µ–Ω–Ω—É—é –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—é
3. **Scan**: –ê–Ω–∞–ª–æ–≥–∏—á–Ω–æ remote —Å–∫–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏—é
4. **Cleanup**: –£–¥–∞–ª–µ–Ω–∏–µ –≤—Ä–µ–º–µ–Ω–Ω—ã—Ö —Ñ–∞–π–ª–æ–≤

## üîç ML –ú–æ–¥–µ–ª—å

### –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞
- **Input**: –°—Ç—Ä–æ–∫–∏ —Å –ø–æ–¥–æ–∑—Ä–∏—Ç–µ–ª—å–Ω—ã–º–∏ —Å–µ–∫—Ä–µ—Ç–∞–º–∏
- **Vectorization**: TF-IDF —Å —Å–∏–º–≤–æ–ª—å–Ω—ã–º–∏ n-–≥—Ä–∞–º–º–∞–º–∏ (3-5)
- **Model**: Logistic Regression (max_iter=1000)
- **Output**: Probability + Binary Classification

### –ö–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏—è —É—Ä–æ–≤–Ω–µ–π
- **High**: –£–≤–µ—Ä–µ–Ω–Ω—ã–µ —Å–µ–∫—Ä–µ—Ç—ã (pred=1) –∏–ª–∏ –Ω–µ—É–≤–µ—Ä–µ–Ω–Ω—ã–µ —Å–ª—É—á–∞–∏
- **Potential**: –£–≤–µ—Ä–µ–Ω–Ω—ã–µ –Ω–µ-—Å–µ–∫—Ä–µ—Ç—ã (pred=0, confidence>0.8)

### –û–±—É—á–µ–Ω–∏–µ
- **Datasets**: –ü–æ–ª–æ–∂–∏—Ç–µ–ª—å–Ω—ã–µ –∏ –æ—Ç—Ä–∏—Ü–∞—Ç–µ–ª—å–Ω—ã–µ –ø—Ä–∏–º–µ—Ä—ã
- **Auto-training**: –ü—Ä–∏ –æ—Ç—Å—É—Ç—Å—Ç–≤–∏–∏ –≥–æ—Ç–æ–≤–æ–π –º–æ–¥–µ–ª–∏
- **Persistence**: –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ —á–µ—Ä–µ–∑ joblib

## ‚öôÔ∏è –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è

### –§–∞–π–ª—ã –Ω–∞—Å—Ç—Ä–æ–µ–∫
- `rules.yml`: Regex –ø—Ä–∞–≤–∏–ª–∞ –ø–æ–∏—Å–∫–∞
- `excluded_extensions.yml`: –ò—Å–∫–ª—é—á–µ–Ω–Ω—ã–µ —Ä–∞—Å—à–∏—Ä–µ–Ω–∏—è —Ñ–∞–π–ª–æ–≤
- `excluded_files.yml`: –ò—Å–∫–ª—é—á–µ–Ω–Ω—ã–µ –∏–º–µ–Ω–∞ —Ñ–∞–π–ª–æ–≤
- `false-positive.yml`: –ü—Ä–∞–≤–∏–ª–∞ —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–∏ –ª–æ–∂–Ω—ã—Ö —Å—Ä–∞–±–∞—Ç—ã–≤–∞–Ω–∏–π

### –ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è
```python
HubType='Azure' # Azure | GutHub
LOGIN_KEY='***' # –ö–ª—é—á –¥–ª—è —à–∏—Ñ—Ä–æ–≤–∞–Ω–∏—è –ª–æ–≥–∏–Ω–∞ NTLM Auth
PASSWORD_KEY='***' # –ö–ª—é—á –¥–ª—è —à–∏—Ñ—Ä–æ–≤–∞–Ω–∏—è –ø–∞—Ä–æ–ª—è NTLM Auth
PAT_KEY='***' # –ö–ª—é—á –¥–ª—è —à–∏—Ñ—Ä–æ–≤–∞–Ω–∏—è PAT —Ç–æ–∫–µ–Ω–∞
HOST='127.0.0.1' # –•–æ—Å—Ç –º–∏–∫—Ä–æ—Å–µ—Ä–≤–∏—Å–∞
PORT='8001' # –ü–æ—Ä—Ç –º–∏–∫—Ä–æ—Å–µ—Ä–≤–∏—Å–∞
API_KEY='***' # API –∫–ª—é—á –¥–ª—è –¥–æ—Å—Ç—É–ø–∞ –∫ —ç—Ç–æ–º—É –º–∏–∫—Ä–æ—Å–µ—Ä–≤–∏—Å—É –∏–∑ –≤–Ω–µ
MAX_WORKERS='10' # –ú–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –∑–∞–ø—É—â–µ–Ω–Ω—ã—Ö –≤–æ—Ä–∫–µ—Ä–æ–≤
TEMP_DIR='tmp/' # –ü–∞–ø–∫–∞ –¥–ª—è —Ä–∞—Å–ø–∞–∫–æ–≤–∫–∏ –∞—Ä—Ö–∏–≤–æ–≤ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–µ–≤ (–∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —É–¥–∞–ª—è—é—Ç—Å—è –ø–æ—Å–ª–µ —Å–∫–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏—è)
```

### –®–∏—Ñ—Ä–æ–≤–∞–Ω–∏–µ
- –í—Å–µ —Ç–æ–∫–µ–Ω—ã –∏ –ø–∞—Ä–æ–ª–∏ —Ö—Ä–∞–Ω—è—Ç—Å—è –≤ –∑–∞—à–∏—Ñ—Ä–æ–≤–∞–Ω–Ω–æ–º –≤–∏–¥–µ
- –ö–ª—é—á–∏ —à–∏—Ñ—Ä–æ–≤–∞–Ω–∏—è –≤ .env —Ñ–∞–π–ª–µ
- –ú–∞—Å—Ç–µ—Ä –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –ø—Ä–∏ –ø–µ—Ä–≤–æ–º –∑–∞–ø—É—Å–∫–µ

## üîí –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å

### –û–±—Ä–∞–±–æ—Ç–∫–∞ —Ñ–∞–π–ª–æ–≤
- –§–∏–ª—å—Ç—Ä–∞—Ü–∏—è –ø–æ—Ç–µ–Ω—Ü–∏–∞–ª—å–Ω–æ –æ–ø–∞—Å–Ω—ã—Ö —Ñ–∞–π–ª–æ–≤ –ø—Ä–∏ —Ä–∞—Å–ø–∞–∫–æ–≤–∫–µ
- –û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ –¥–ª–∏–Ω—ã –ø—É—Ç–µ–π (MAX_PATH = 250)
- –ò—Å–∫–ª—é—á–µ–Ω–∏–µ absolute paths –∏ ".." –≤ –∞—Ä—Ö–∏–≤–∞—Ö

### –ê—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è
- API –∫–ª—é—á–∏ —Å –∫—Ä–∏–ø—Ç–æ–≥—Ä–∞—Ñ–∏—á–µ—Å–∫–∏ —Å—Ç–æ–π–∫–∏–º —Å—Ä–∞–≤–Ω–µ–Ω–∏–µ–º
- –ú–Ω–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω—ã–µ –º–µ—Ç–æ–¥—ã –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏ –¥–ª—è —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–µ–≤
- –®–∏—Ñ—Ä–æ–≤–∞–Ω–∏–µ –≤—Å–µ—Ö —á—É–≤—Å—Ç–≤–∏—Ç–µ–ª—å–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö

### –û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è —Å–∫–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏—è
- –ú–∞–∫—Å–∏–º—É–º `100` —Å–µ–∫—Ä–µ—Ç–æ–≤ –Ω–∞ —Ñ–∞–π–ª
- –û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ –¥–ª–∏–Ω—ã —Å—Ç—Ä–æ–∫ (`7000` —Å–∏–º–≤–æ–ª–æ–≤)
- –•–µ—à–∏—Ä–æ–≤–∞–Ω–∏–µ –ø—Ä–∏ –ø—Ä–µ–≤—ã—à–µ–Ω–∏–∏ –ª–∏–º–∏—Ç–æ–≤, –æ—Ç–ø—Ä–∞–≤–∫–∞ –≤ –≤–∏–¥–µ –æ–¥–Ω–æ–≥–æ —Å–µ–∫—Ä–µ—Ç–∞, –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ —Å–ø–µ—Ü–∏–∞–ª–∏—Å—Ç–æ–º (—á—Ç–æ–±—ã –Ω–µ –∑–∞–±–∏–≤–∞—Ç—å –æ—Ç—á–µ—Ç—ã –ø–æ—Ç–µ–Ω—Ü–∏–∞–ª—å–Ω–æ –æ–¥–∏–Ω–∞–∫–æ–≤—ã–º–∏ `false-positive` —Å–µ–∫—Ä–µ—Ç–∞–º–∏)

## üìä –ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å

### –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏
- **–ü–∞—Ä–∞–ª–ª–µ–ª—å–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞**: –§–∞–π–ª—ã —Å–∫–∞–Ω–∏—Ä—É—é—Ç—Å—è `–±–∞—Ç—á–∞–º–∏ –ø–æ 5`. –ö–∞–∂–¥–∞—è –ø—è—Ç–µ—Ä–∫–∞ —Å–∫–∞–Ω–∏—Ä—É–µ—Ç—Å—è –ø–∞—Ä–∞–ª–ª–µ–ª—å–Ω–æ. –°–ª–µ–¥—É—é—â–∞—è –ø—è—Ç–µ—Ä–∫–∞ –∂–¥–µ—Ç –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è –ø—Ä–µ–¥—ã–¥—É—â–µ–π. **–¶–µ–ª—å:** `–ö–æ–Ω—Ç—Ä–æ–ª—å –Ω–∞–≥—Ä—É–∑–∫–∏` - –Ω–µ —Å–∫–∞–Ω–∏—Ä–æ–≤–∞—Ç—å –≤—Å–µ —Ñ–∞–π–ª—ã –æ–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω–æ, —á—Ç–æ–±—ã –∏–∑–±–µ–∂–∞—Ç—å –ø–µ—Ä–µ–≥—Ä—É–∑–∫–∏ –ø–∞–º—è—Ç–∏ –∏ CPU.
- **–†–∞–∑–¥–µ–ª–µ–Ω–∏–µ –Ω–∞–≥—Ä—É–∑–∫–∏**: I/O –∏ CPU –æ–ø–µ—Ä–∞—Ü–∏–∏ –≤ —Ä–∞–∑–Ω—ã—Ö –ø—É–ª–∞—Ö
- **–ö–µ—à–∏—Ä–æ–≤–∞–Ω–∏–µ –º–æ–¥–µ–ª–∏**: Singleton pattern –¥–ª—è ML –º–æ–¥–µ–ª–∏
- **–ê—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–æ—Å—Ç—å**: –ù–µ–±–ª–æ–∫–∏—Ä—É—é—â–∏–µ –æ–ø–µ—Ä–∞—Ü–∏–∏ –≤–µ–∑–¥–µ –≥–¥–µ –≤–æ–∑–º–æ–∂–Ω–æ

### –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥
- Health endpoint —Å –º–µ—Ç—Ä–∏–∫–∞–º–∏ –æ—á–µ—Ä–µ–¥–∏
- –ü–æ–¥—Ä–æ–±–Ω–æ–µ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –≤—Ä–µ–º–µ–Ω–∏ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è
- –û—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–∞ –æ–±—Ä–∞–±–æ—Ç–∞–Ω–Ω—ã—Ö —Ñ–∞–π–ª–æ–≤
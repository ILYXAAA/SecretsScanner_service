#
# regexes-based rules to find any secrets
#
- id: token.slack
  message: Slack Token
  pattern: "(xox[pboa]-[0-9]{12}-[0-9]{12}-[0-9]{12}-[a-z0-9]{32})"
  severity: HIGH
- id: private.key
  message: Private key
  pattern: "\\s*-----\\s*BEGIN[ A-Z0-9_-]*PRIVATE KEY[ A-Z0-9_-]*\\s*-----"
  severity: HIGH
- id: id.url
  message: Password in URL
  pattern: "[a-zA-Z]{3,10}://[^/\\s:@]{3,20}:[^/\\s:@]{3,20}@.{1,100}[\"'\\s]"
  severity: HIGH
- id: id.pass
  message: Password
  pattern: "(?:(?:([p|P][a|A][s|S][s|S][w|W]))|(?:([t|T][o|O][k|K][e|E][n|N]))|(?:([p|P][a|A][s|S][s|S]_))|(?:(_[p|P][a|A][s|S][s|S]))|(?:([p|P][s|S][w|W][d|D]))|(?:([p|P][w|W][d|D]))|(?:([c|C][r|R][e|E][d|D]))|(?:([s|S][e|E][c|C][r|R][e|E][t|T]))).{0,60}(?:(?:(?=.*[0-9])(?=.*[a-z])(?=.*[A-Z]))|(?:(?=.*[a-z])(?=.*[A-Z])(?=.*[*.!@#$%^&(){}[\\]:;<>,.?\/~_+\\-=|]))|(?:(?=.*[0-9])(?=.*[A-Z])(?=.*[*.!@#$%^&(){}[\\]:;<>,.?\/~_+\\-=|]))|(?:(?=.*[0-9])(?=.*[a-z])(?=.*[*.!@#$%^&(){}[\\]:;<>,.?\/~_+\\-=|]))|(?:(?=.*[a-z])(?=.*[*.!@#$%^&(){}[\\]:;<>,.?\/~_+\\-=|]))|(?:(?=.*[0-9])(?=.*[*.!@#$%^&(){}[\\]:;<>,.?\/~_+\\-=|]))|(?:(?=.*[0-9])(?=.*[a-z]))|(?:(?=.*[A-Z])(?=.*[*.!@#$%^&(){}[\\]:;<>,.?\/~_+\\-=|]))).{6,32}"
  severity: HIGH
- id: id.apikey
  message: API KEY
  pattern: "[a|A][p|P][i|I][_]?[k|K][e|E][y|Y]+.{1,70}"
  severity: HIGH
- id: id.keytabs
  message: Keytab
  pattern: "(?:(?:([k|K][e|E][y|Y][s|S][t|T][o|O][r|R][e|E]))|(?:([k|K][e|E][y|Y][t|T][a|A][b|B]))|(?:([t|T][r|R][u|U][s|S][t|T][s|S][t|T][o|O][r|R][e|E]))).{0,60}(?:(?:(?=.*[0-9])(?=.*[a-z])(?=.*[A-Z]))|(?:(?=.*[a-z])(?=.*[A-Z])(?=.*[*.!@#$%^&(){}[\\]:;<>,.?\/~_+\\-=|]))|(?:(?=.*[0-9])(?=.*[A-Z])(?=.*[*.!@#$%^&(){}[\\]:;<>,.?\/~_+\\-=|]))|(?:(?=.*[0-9])(?=.*[a-z])(?=.*[*.!@#$%^&(){}[\\]:;<>,.?\/~_+\\-=|]))|(?:(?=.*[a-z])(?=.*[*.!@#$%^&(){}[\\]:;<>,.?\/~_+\\-=|]))|(?:(?=.*[0-9])(?=.*[*.!@#$%^&(){}[\\]:;<>,.?\/~_+\\-=|]))|(?:(?=.*[0-9])(?=.*[a-z]))|(?:(?=.*[A-Z])(?=.*[*.!@#$%^&(){}[\\]:;<>,.?\/~_+\\-=|]))).{6,32}"
  severity: HIGH
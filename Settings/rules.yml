#
# regexes-based rules to find any secrets
#
- id: token.slack
  message: Slack Token
  pattern: "(xox[pboa]-[0-9]{12}-[0-9]{12}-[0-9]{12}-[a-z0-9]{32})"
  severity: HIGH

- id: private.key
  message: Private key
  pattern: "\\s*-----\\s*BEGIN[ A-Z0-9_-]*PRIVATE KEY[ A-Z0-9_-]*\\s*-----"
  severity: HIGH

- id: id.url
  message: Password in URL
  pattern: "[a-zA-Z]{3,10}://[^/\\s:@]{3,20}:[^/\\s:@]{3,20}@.{1,100}[\"'\\s]"
  severity: HIGH

- id: id.pass
  message: Password
  pattern: "(?:(?:([pP][aA][sS][sS][wW]))|(?:([pP][aA][sS][sS]_))|(?:(_[pP][aA][sS][sS]))|(?:([pP][sS][wW][dD]))|(?:([pP][wW][dD]))|(?:([cC][rR][eE][dD]))|(?:([sS][eE][cC][rR][eE][tT]))).{0,60}(?:(?:(?=.*[0-9])(?=.*[a-z])(?=.*[A-Z]))|(?:(?=.*[a-z])(?=.*[A-Z])(?=.*[*.!@#$%^&(){}[\\]:;<>,.?\/~_+\\-=|]))|(?:(?=.*[0-9])(?=.*[A-Z])(?=.*[*.!@#$%^&(){}[\\]:;<>,.?\/~_+\\-=|]))|(?:(?=.*[0-9])(?=.*[a-z])(?=.*[*.!@#$%^&(){}[\\]:;<>,.?\/~_+\\-=|]))|(?:(?=.*[a-z])(?=.*[*.!@#$%^&(){}[\\]:;<>,.?\/~_+\\-=|]))|(?:(?=.*[0-9])(?=.*[*.!@#$%^&(){}[\\]:;<>,.?\/~_+\\-=|]))|(?:(?=.*[0-9])(?=.*[a-z]))|(?:(?=.*[A-Z])(?=.*[*.!@#$%^&(){}[\\]:;<>,.?\/~_+\\-=|]))).{6,32}"
  severity: HIGH

- id: id.token
  message: Token
  pattern: "(?:([tT][oO][kK][eE][nN])).{0,60}(?:(?:(?=.*[0-9])(?=.*[a-z])(?=.*[A-Z]))|(?:(?=.*[a-z])(?=.*[A-Z])(?=.*[*.!@#$%^&(){}[\\]:;<>,.?\/~_+\\-=|]))|(?:(?=.*[0-9])(?=.*[A-Z])(?=.*[*.!@#$%^&(){}[\\]:;<>,.?\/~_+\\-=|]))|(?:(?=.*[0-9])(?=.*[a-z])(?=.*[*.!@#$%^&(){}[\\]:;<>,.?\/~_+\\-=|]))|(?:(?=.*[a-z])(?=.*[*.!@#$%^&(){}[\\]:;<>,.?\/~_+\\-=|]))|(?:(?=.*[0-9])(?=.*[*.!@#$%^&(){}[\\]:;<>,.?\/~_+\\-=|]))|(?:(?=.*[0-9])(?=.*[a-z]))|(?:(?=.*[A-Z])(?=.*[*.!@#$%^&(){}[\\]:;<>,.?\/~_+\\-=|]))).{6,32}"
  severity: HIGH

- id: id.apikey
  message: API KEY
  pattern: "[aA][pP][iI][_]?[kK][eE][yY]+.{1,70}"
  severity: HIGH

- id: id.keytabs
  message: Keytab
  pattern: "(?:(?:([kK][eE][yY][sS][tT][oO][rR][eE]))|(?:([kK][eE][yY][tT][aA][bB]))|(?:([tT][rR][uU][sS][tT][sS][tT][oO][rR][eE]))).{0,60}(?:(?:(?=.*[0-9])(?=.*[a-z])(?=.*[A-Z]))|(?:(?=.*[a-z])(?=.*[A-Z])(?=.*[*.!@#$%^&(){}[\\]:;<>,.?\/~_+\\-=|]))|(?:(?=.*[0-9])(?=.*[A-Z])(?=.*[*.!@#$%^&(){}[\\]:;<>,.?\/~_+\\-=|]))|(?:(?=.*[0-9])(?=.*[a-z])(?=.*[*.!@#$%^&(){}[\\]:;<>,.?\/~_+\\-=|]))|(?:(?=.*[a-z])(?=.*[*.!@#$%^&(){}[\\]:;<>,.?\/~_+\\-=|]))|(?:(?=.*[0-9])(?=.*[*.!@#$%^&(){}[\\]:;<>,.?\/~_+\\-=|]))|(?:(?=.*[0-9])(?=.*[a-z]))|(?:(?=.*[A-Z])(?=.*[*.!@#$%^&(){}[\\]:;<>,.?\/~_+\\-=|]))).{6,32}"
  severity: HIGH

- id: id.Bearer
  message: Bearer token
  pattern: "Bearer\\s[\\d|a-f]{8}-[\\d|a-f]{4}-[\\d|a-f]{4}-[\\d|a-f]{4}-[\\d|a-f]{12}"
  severity: HIGH

- id: id.Telegram
  message: Telegram token
  pattern: "[0-9]{8,10}:[\\w_-]{35}"
  severity: HIGH

- id: id.Jwt
  message: JWT token
  pattern: "eyJ[A-Za-z0-9\\-_]+\\.[A-Za-z0-9\\-_]+\\.[A-Za-z0-9\\-_]+"
  severity: HIGH

- id: id.private_key_id 
  message: private_key_id
  pattern: '["'']?private_key_id["'']?\s*[:=]\s*["'']?[a-f0-9]{16,32}["'']?'
  severity: HIGH